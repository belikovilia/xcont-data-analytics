<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä PDF: –≥—Ä—É–ø–ø—ã –°5 –∏ –°10</title>
    <link rel="stylesheet" href="./styles/styles.css" />
    <!-- PDF.js (–±–µ–∑ –≤–æ—Ä–∫–µ—Ä–∞, –æ—Ç–∫–ª—é—á–∏–º –≤ app.js) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js" crossorigin="anonymous"></script>
    <!-- jsPDF –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" crossorigin="anonymous"></script>
    <!-- –ù–∞—à –º–æ–¥—É–ª—å PDF -->
    <script src="./js/pdf.js"></script>
    <!-- –ò–∫–æ–Ω–æ—á–Ω—ã–π —à—Ä–∏—Ñ—Ç (Material Symbols) -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
  </head>
  <body>
    <main class="container">
      <section class="card">
        <h1>–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –æ—Ç—á–µ—Ç–æ–≤ –ø–∏—Ü—Ü–µ—Ä–∏–∏</h1>
        <p class="muted">–ó–∞–≥—Ä—É–∑–∏—Ç–µ PDF-–æ—Ç—á–µ—Ç –∏–ª–∏ —Ç–µ–∫—Å—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–ø–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–π.</p>

        <div class="mode-switch" role="tablist" aria-label="–°–ø–æ—Å–æ–± –≤–≤–æ–¥–∞">
          <button id="modePdfBtn" class="seg active" role="tab" aria-selected="true">PDF</button>
          <button id="modeTextBtn" class="seg" role="tab" aria-selected="false">–¢–µ–∫—Å—Ç</button>
        </div>

        <div id="inputPdf" class="input-mode">
          <div id="dropZone" class="drop-zone">
            <div class="drop-zone-content">
              <div class="drop-zone-icon">üìÑ</div>
              <div class="drop-zone-text">
                <span class="drop-zone-primary">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ PDF —Ñ–∞–π–ª —Å—é–¥–∞</span>
                <span class="drop-zone-secondary">–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</span>
              </div>
            </div>
            <input id="pdfInput" type="file" accept="application/pdf" style="display: none;" />
          </div>
        </div>

        <div id="inputText" class="input-mode hidden">
          <textarea id="textAreaInput" class="text-area" rows="8" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞‚Ä¶"></textarea>
          <div style="margin-top:10px; display:flex; gap:10px; align-items:center;">
            <button id="analyzeTextBtn" class="button" type="button">–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç</button>
            <span class="muted" style="font-size:12px;">–í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ—Ç—á—ë—Ç–∞. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.</span>
          </div>
        </div>

        <div class="control-row">
          <label id="labelToggleGroupDetails" class="dev-only hidden">
            <input id="toggleGroupDetails" type="checkbox" /> –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
          </label>
          <label id="labelToggleDebug" class="dev-only hidden">
            <input id="toggleDebug" type="checkbox" /> –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ (–ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏)
          </label>
        </div>

        <div class="controls">
          <div class="control">
            <label for="topSelect">–í—ã–±–æ—Ä –¢–û–ü</label>
            <select id="topSelect" class="select">
              <option value="3">–¢–û–ü-3</option>
              <option value="5">–¢–û–ü-5</option>
              <option value="10">–¢–û–ü-10</option>
            </select>
            <div id="errTop" class="error-text hidden"></div>
          </div>

          <div class="control">
            <label for="storeSelect">–ü–∏—Ü—Ü–µ—Ä–∏—è</label>
            <input id="storeSearch" class="input" type="text" placeholder="–ü–æ–∏—Å–∫‚Ä¶" />
            <select id="storeSelect" class="select">
              <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
            </select>
            <div id="storeResults" class="dropdown hidden"></div>
            <div id="errStore" class="error-text hidden"></div>
          </div>

          <div class="control">
            <label for="periodSelect">–ü–µ—Ä–∏–æ–¥</label>
            <select id="periodSelect" class="select">
              <option value="">‚Äî –≤—ã–±—Ä–∞—Ç—å ‚Äî</option>
            </select>
            <div id="errPeriod" class="error-text hidden"></div>
          </div>

          <div class="btns-row">
            <button id="previewPdfBtn" class="button" type="button"><span class="icon">visibility</span>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</button>
            <button id="downloadPdfBtn" class="button ghost" type="button"><span class="icon">download</span>–°–∫–∞—á–∞—Ç—å</button>
            <button id="textReportBtn" class="button ghost" type="button"><span class="icon">description</span>–¢–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á—ë—Ç</button>
          </div>
        </div>

        <div id="rulesBanner" class="rules-banner hidden">
          <div class="rules-banner-title">–ë–∞–∑–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞</div>
          <div class="rules-banner-desc">–ü–æ–ª–æ–∂–∏—Ç–µ —Ñ–∞–π–ª—ã –ø—Ä–∞–≤–∏–ª —Ä—è–¥–æ–º —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π: <code>rules_c5.txt</code> –∏ <code>rules_c10.txt</code>, –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∏–∂–µ –≤—Ä—É—á–Ω—É—é.</div>
          <div class="rules-actions">
            <label class="button ghost">–ó–∞–≥—Ä—É–∑–∏—Ç—å C5
              <input id="rulesC5File" type="file" accept=".txt" />
            </label>
            <label class="button ghost">–ó–∞–≥—Ä—É–∑–∏—Ç—å C10
              <input id="rulesC10File" type="file" accept=".txt" />
            </label>
            <span id="rulesStatus" class="file-name">C5: ‚Äî, C10: ‚Äî</span>
          </div>
        </div>

        <div id="status" class="status"></div>
      </section>

      <section id="results" class="results hidden">
        <div class="summary">
          <div><strong>–°—Ç—Ä–∞–Ω–∏—Ü:</strong> <span id="pagesCount">‚Äì</span></div>
          <div><strong>–°–æ–≤–ø–∞–¥–µ–Ω–∏–π –°5:</strong> <span id="c5Count">0</span></div>
          <div><strong>–°–æ–≤–ø–∞–¥–µ–Ω–∏–π –°10:</strong> <span id="c10Count">0</span></div>
        </div>

        <details open>
          <summary>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –°5 (<span id="c5GroupedTotal">0</span>)</summary>
          <ol id="groupC5List" class="result-list"></ol>
        </details>

        <details>
          <summary>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –°10 (<span id="c10GroupedTotal">0</span>)</summary>
          <ol id="groupC10List" class="result-list"></ol>
        </details>

        <details id="devUngroupedC5" class="hidden">
          <summary>–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –°5</summary>
          <ol id="ungroupedC5" class="result-list"></ol>
        </details>

        <details id="devUngroupedC10" class="hidden">
          <summary>–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –°10</summary>
          <ol id="ungroupedC10" class="result-list"></ol>
        </details>

        <details id="devListC5" class="hidden">
          <summary>–°—Ç—Ä–æ–∫–∏ —Å –°5 (<span id="c5CountInline">0</span>)</summary>
          <ol id="listC5" class="result-list"></ol>
        </details>

        <details id="devListC10" class="hidden">
          <summary>–°—Ç—Ä–æ–∫–∏ —Å –°10 (<span id="c10CountInline">0</span>)</summary>
          <ol id="listC10" class="result-list"></ol>
        </details>

        <!-- –¢–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á—ë—Ç -->
        <section id="textReportSection" class="card hidden" style="margin-top:16px;">
          <div style="display:flex; justify-content:space-between; align-items:center; gap:8px;">
            <h3 style="margin:0;">–¢–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç—á—ë—Ç</h3>
            <button id="copyTextReportBtn" class="button ghost" type="button" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å"><span class="icon">content_copy</span>–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
          </div>
          <pre id="textReport" class="text-report" style="margin-top:10px; white-space:pre-wrap; word-break:break-word;"></pre>
        </section>

        <!-- DEV: —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ñ–∞–π–ª–∞–º –ø—Ä–∞–≤–∏–ª -->
        <section id="devRulesStats" class="card dev-only hidden" style="margin-top:16px;">
          <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–ª–æ–≤–∞—Ä–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–π</h3>
          <div class="summary">
            <div><strong>C5: –≥—Ä—É–ø–ø</strong> <span id="rulesC5GroupsCount">0</span></div>
            <div><strong>C10: –≥—Ä—É–ø–ø</strong> <span id="rulesC10GroupsCount">0</span></div>
          </div>
          <div class="grid-2" style="gap:16px; margin-top:10px;">
            <div>
              <h4 style="margin:4px 0;">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ C5</h4>
              <ol id="rulesC5GroupsList" class="result-list"></ol>
            </div>
            <div>
              <h4 style="margin:4px 0;">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ C10</h4>
              <ol id="rulesC10GroupsList" class="result-list"></ol>
            </div>
          </div>
        </section>
      </section>
    </main>

    <!-- –ü—Ä–µ–ª–æ–∞–¥–µ—Ä –ø–æ–≤–µ—Ä—Ö —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
    <div id="preloader" class="preloader hidden" aria-live="polite" aria-busy="true">
      <div class="loader-card">
        <div class="spinner" aria-hidden="true"></div>
        <div id="loaderText" class="loader-text">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞‚Ä¶</div>
      </div>
    </div>

    <script src="./js/app.js"></script>
    <div id="toast" class="toast hidden" role="status" aria-live="polite"></div>
  </body>
  </html>